<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>ECE 4160: Lab 4</title>
        <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:500,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,800,800i" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
            <a class="navbar-brand js-scroll-trigger" href="#page-top">
                <span class="d-block d-lg-none">Eshita Sangani</span>
                <span class="d-none d-lg-block"><img class="img-fluid img-profile rounded-circle mx-auto mb-2" src="assets/profile.jpg" alt="..." /></span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="index.html">About</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab1.html">Lab 1</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab2.html" >Lab 2</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab3.html">Lab 3</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab4.html" style="color: rgb(31, 78, 47);">Lab 4</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab5.html">Lab 5</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab6.html">Lab 6</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab7.html">Lab 7</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab8.html">Lab 8</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab9.html">Lab 9</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab10.html">Lab 10</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab11.html">Lab 11</a></li>
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="Lab12.html">Lab 12</a></li>
                </ul>
            </div>
        </nav>
    <!-- Page Content-->
    <section class="resume-section" id="experience">
        <div class="resume-section-content">
            <h2 class="mb-2">Lab 4 <span class="text-primary">IMU Sensor</span></h2>
            <p class="mb-5">
                
                The purpose of this lab was to gain familiarity with IMU sensors, another of 
                the sensors that we will equip our robot with as well beginning
                the run stunts on our robot. 
                </p>

            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0">IMU Setup</h3>
                    
                    <p>
                        The IMU measures angular rate and force/acceleration by an 
                        object - we focus on the accelerometer + gyroscope data. 

                        I conncected the IMU to the Artemis using a QWICC connector 
                        as seen in the image below. 
                    </p>

                    <p> 
                        <img src="assets/port.jpg" alt="..." width="55%" />
                    </p>
                       
                    <p>
                        I began by installing the SparkFun 9DOF IMU Breakout - 
                        ICM 20948 library and using the Example1_Basics example.
                        This prints out the raw accelerometer and gyroscope values,
                        which can be visualized through the serial plotter. In this 
                        example, the AD0_VAL is used to change the address of an IMU 
                        if multiple IMU's are used. In this case, we are only using
                        1 IMU so the AD0_VAL should be set to 1. 

                        
                    </p>
                    <p>
                        When running this example, I noticed that one of the 
                        acceleration readings is consistently high - displaying 
                        gravity - while the others are close to 0 as seen in the 
                        video. The acceleration usually changes with rotation. 
                        The gyroscope measures the lateral movement (rotation 
                        about the axes), also does not feel the effect of gravity,
                        and is very sensitive to little movements. 
     
                    </p>

                    <p> 
                        <img src="assets/port.jpg" alt="..." width="55%" />
                    </p>

                    <p> 
                        For debugging purposes, I added a visual indicator to see
                        if the board is running/is stuck. It will blink three times
                        if the Artemis has turned on with a slight delay.
                    </p>
                   
                    <p> 
                        <script src="https://gist.github.com/eshitasangani/0eb8fcfd712456b3f0576e9c93bb12e8.js"></script>
                    </p>

                </div>
            </div>

            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0">ACCELERROMETER</h3>
                   
                    <p>
                        In order to convert the accelerometer data to pitch and roll, I used
                        the sample code from the IMU lecture as a base. Pitch is the 
                        rotation around the X axis and roll is the rotation around the Y axis
                        and can be calculated as seen below. 

                    </p>
                    <p>
                        Pitch: Œ∏ = atan2(x_accel , z_accel)
                        Roll: ùúô = atan2(y_accel, z_accel)
                    </p>
                    <p> 
                        <img src="assets/port.jpg" alt="..." width="55%" />
                    </p>

                    <p>
                        I then visualized the output at -90, 0, and 90 degrees for pitch and roll. 
                    </p>
                    <p> 
                        <!-- insert image here -->
                        <img src="assets/pitch-90.jpg" alt="..." width="55%" />
                    </p>
                    <p> 
                        <!-- insert image here -->
                        <img src="assets/pitch90.jpg" alt="..." width="55%" />
                    </p>
                    <p> 
                        <!-- insert image here -->
                        <img src="assets/roll-90.jpg" alt="..." width="55%" />
                    </p>
                    <p> 
                        <!-- insert image here -->
                        <img src="assets/roll90.jpg" alt="..." width="55%" />
                    </p>

                    <h4 class="mb-0"> Accelerometer Noise </h3>
                        <p> 
                            However, the accelerometer is very noisy, especailly if the RC car is running, because of the noise 
                            from the motors. I ran an FFT on that data - resulting in not too much noise. This led me to use 
                            a low pas filter to make the accelerometer more sensitive to that noise when it is on the car. 
                            The FFT analysis is shown below. Through this, the frequency found was under .1 Hz, illustrating 
                            that the noise was reduced. 
                        </p>

                </div>
            </div>

            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0">TOF 1 Readings</h3>
                   
                    <p>

                    </p>
                </div>
            </div>

            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0">TOF Modes</h3>
                   
                    <p>
                        The TOF sensor has 3 modes that can be used - short, medium, and long. 
                        Long distance mode allows for the longest range - 4m but is very 
                        sensitive to ambient light. Short distance mode is not as sensitive 
                        to ambient light, but has a max ranging distance of 1.3m. 
                        I chose to use short distance mode because of its resistance against 
                        ambient light as it will lessen the overall error as it 
                        can operate in a bright area but at the cost of the range distance. 

                    </p>
                    <p>
                        After deciding which mode to use, I used the ReadDistance example 
                        from the Soarkfun library on one of the TOF sensors to understand 
                        how the short mode would use. I took the measurements in 4 cm 
                        increments from 0 cm to 150 cm. The standard deviation of the data 
                        is miniscule, confirming the repeatability of the short distance mode.
                        Using the stopRanging() function, I was able to see that 
                        the ranging time is 97ms with .stopRanging() and 95ms without 
                        the .stopRanging() function.

                    </p>

                    <p> 
                        <img src="assets/port.jpg" alt="..." width="55%" />
                    </p>
                </div>
            </div>

            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0">2 TOF Sensors</h3>
                   
                    <p>
                        When hooking up both TOF sensors, I had to 
                        I set up the initialization of both TOF sensors first, shut down one 
                        of the sensors, and change the address of the other sensor. Then the first
                        sensor is turned bck on. 
                        My loop executes __ fast, and the current limiting factor is 
                        the ranging time. 
                        One issue that I had faced was the speed of the readings, it would 
                        sometimes get stuck and not continue to display the measurements. 
                        I used .startRanging() instead of .stopRanging() to only iitialize 
                        the sensors once and also used .checkForDataReady() to only print
                        the appropiate distance reading if there is a new reading available. 
                        This is similar to the implementation of the notification handler
                        in the previous lab. 

                    </p>
                </div>
            </div>

            <div class="d-flex flex-column flex-md-row justify-content-between mb-5">
                <div class="flex-grow-1">
                    <h3 class="mb-0">TOF + Bluetooth</h3>
                   
                    <p>
                        Combining the TOF sensor data with the bluetooh functionality from the 
                        previous lab, I slightly altered the temperature command to 
                        instead be able to send TOF sensor data from the Artemis to the computer. 
                        To add a new command, the arduino sketch, the cmd_types file, as well as the demo.ipynb file needed 
                        to be updated. The new command is able to collect data from both 
                        sensors for a specified amount of time and then the computer receives 
                        the reading from both sensors. 

                    </p>
                </div>
            </div>

        </div>
    </section>

    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script>
</body>

</html>